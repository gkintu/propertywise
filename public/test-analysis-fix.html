<!DOCTYPE html>
<html>
<head>
    <title>Test Analysis Data Fix</title>
</head>
<body>
    <h1>Test Analysis Data Setup</h1>
    <p>This will set up the correct test data and redirect to the analysis result page.</p>
    
    <button id="setup-api-response">Setup API Response Format (wrapped)</button>
    <button id="setup-direct-format">Setup Direct PropertyAnalysis Format</button>
    <button id="clear-data">Clear All Data</button>
    
    <div id="status"></div>

    <script>
        // Test data that matches the expected PropertyAnalysis structure
        const testAnalysisData = {
            propertyDetails: {
                address: "Borgenvei 5, 0263 Oslo",
                price: 4200000,
                bedrooms: 3,
                size: 85,
                propertyType: "apartment",
                yearBuilt: 1995
            },
            strongPoints: [
                {
                    title: "Modern Kitchen",
                    description: "Recently upgraded kitchen with modern appliances and granite countertops"
                },
                {
                    title: "Great Location", 
                    description: "Walking distance to public transport and shopping centers"
                },
                {
                    title: "Storage Space",
                    description: "Excellent storage solutions throughout the apartment"
                },
                {
                    title: "Natural Light",
                    description: "Large windows providing abundant natural light"
                }
            ],
            concerns: [
                {
                    title: "Window Maintenance",
                    description: "Some windows may need replacement in the near future"
                },
                {
                    title: "Flooring Issues",
                    description: "Hardwood floors show signs of wear and may need refinishing"
                },
                {
                    title: "Bathroom Updates",
                    description: "Bathroom fixtures are dated and could benefit from modernization"
                },
                {
                    title: "Electrical System",
                    description: "Electrical system may need inspection and potential upgrades"
                }
            ],
            summary: "This 3-room apartment offers good value in a desirable Oslo location. While it has some maintenance needs, the strong points outweigh the concerns for most buyers.",
            bottomLine: "A solid investment opportunity with room for value-add improvements. Priced competitively for the area."
        };

        // API Response format (wrapped)
        const apiResponseFormat = {
            analysis: testAnalysisData
        };

        document.getElementById('setup-api-response').addEventListener('click', function() {
            localStorage.setItem('analysisResult', JSON.stringify(apiResponseFormat));
            localStorage.removeItem('analysisError');
            document.getElementById('status').innerHTML = '<p style="color: green;">‚úÖ API Response format data set! Ready to test.</p>';
            console.log('Set API response format:', apiResponseFormat);
            
            // Redirect after a moment
            setTimeout(() => {
                window.location.href = '/analysis-result';
            }, 1500);
        });

        document.getElementById('setup-direct-format').addEventListener('click', function() {
            localStorage.setItem('analysisResult', JSON.stringify(testAnalysisData));
            localStorage.removeItem('analysisError');
            document.getElementById('status').innerHTML = '<p style="color: green;">‚úÖ Direct PropertyAnalysis format data set! Ready to test.</p>';
            console.log('Set direct format:', testAnalysisData);
            
            // Redirect after a moment
            setTimeout(() => {
                window.location.href = '/analysis-result';
            }, 1500);
        });

        document.getElementById('clear-data').addEventListener('click', function() {
            localStorage.removeItem('analysisResult');
            localStorage.removeItem('analysisError');
            document.getElementById('status').innerHTML = '<p style="color: orange;">üóëÔ∏è All data cleared!</p>';
        });

        // Show current state
        const currentData = localStorage.getItem('analysisResult');
        if (currentData) {
            document.getElementById('status').innerHTML = '<p style="color: blue;">‚ÑπÔ∏è Data exists in localStorage. Check browser console for details.</p>';
            console.log('Current localStorage data:', JSON.parse(currentData));
        } else {
            document.getElementById('status').innerHTML = '<p style="color: gray;">No data in localStorage currently.</p>';
        }
    </script>
</body>
</html>
